"use strict";(self.webpackChunkconsumer=self.webpackChunkconsumer||[]).push([[6813,7675],{11501:(e,t,s)=>{s.d(t,{A:()=>c});var a=s(69499),i=s(61995);class l extends a.Component{constructor(){super(...arguments),this.setMargin=()=>("standard"===this.props.margin?this.margin="standard-margin":"small"===this.props.margin?this.margin="small-margin":"custom"===this.props.margin?this.margin="custom-margin":"campaign"===this.props.margin?this.margin="campaign-margin":this.margin="",this.margin)}render(){return(0,i.jsx)("div",{className:`base-component ${this.setMargin()} ${this.props.className}`,children:this.props.children})}}const c=l},24827:(e,t,s)=>{s.d(t,{A:()=>i});s(69499);var a=s(61995);const i=()=>(0,a.jsx)("div",{className:"loader-wrapper",children:(0,a.jsx)("div",{className:"loader"})})},48666:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfQAAAH0CAIAAABEtEjdAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAEnQAABJ0Ad5mH3gAAAawSURBVHhe7dQBDQAADMOg+5c6FffRgAhuAOTIHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgcIkjtAkNwBguQOECR3gCC5AwTJHSBI7gBBcgfI2R5jTYfLh3foSgAAAABJRU5ErkJggg=="},49055:(e,t,s)=>{s.d(t,{q:()=>a});const a=(e,t,s)=>{let a,i=0;return s?(window&&window.outerWidth&&window.outerWidth<768?i=6:a=window&&window.outerWidth&&window.outerWidth<=768&&window.outerWidth<992&&s?e%s:e%t,1==a?i=6:2==a?i=8:3==a?i=10:4==a&&(i=12)):(a=e%t,1==a?i=6:2==a?i=8:3==a?i=10:4==a&&(i=12)),i}},52327:(e,t,s)=>{s.r(t),s.d(t,{default:()=>c});var a=s(69499),i=s(61995);class l extends a.Component{constructor(e){super(e),this.handleScroll=()=>{const e=document.querySelectorAll(".animation-rise-and-fade");if(e)for(let t=0;t<e.length;t++){let s=e[t],a=s.getBoundingClientRect(),i=window.innerHeight>=a.top,l=s.style.transform.split(/\w+\(|\);?/)[1].split("%")[0],c=0;l>0?i&&(l-=1,c+=.3):(l=0,c=1),s.style.transform=`translateY(${l}%)`,s.style.opacity=c}}}componentDidMount(){window&&window.addEventListener("scroll",this.handleScroll)}render(){const{position:e}=this.props||{};let t,s;return s=isNaN(e)?0:e,t={transform:`translateY(${s}%)`},(0,i.jsx)("div",{className:"animation-rise-and-fade",style:t,children:this.props.children})}}const c=l},66243:(e,t,s)=>{s.d(t,{A:()=>l});s(69499);var a=s(98558),i=s(61995);const l=e=>{const{iconValue:t=null,linkUrl:s=null,linkName:l=null,size:c=16,mapInfo:r=null,noLocation:n=!1,withViewOnMap:o=!1}=e;return t&&l&&l.value?(0,i.jsxs)("div",{className:"details-wrapper",children:[(0,i.jsx)("i",{className:`icon icon-${t} mr-1 mr-md-2`,style:{fontSize:c+"px"}}),s&&s.length&&n?(0,i.jsx)("a",{href:s,children:(0,i.jsx)(a.Text,{field:l})}):s&&s.length&&o?(0,i.jsxs)("div",{className:"separated-location",children:[(0,i.jsx)("span",{children:(0,i.jsx)(a.Text,{field:l})}),(0,i.jsx)("a",{href:s+"#/profile?location="+r,children:"View on map"})]}):s&&s.length?(0,i.jsx)("a",{href:s+"#/profile?location="+r,children:(0,i.jsx)(a.Text,{field:l})}):(0,i.jsx)(a.Text,{field:l})]}):null}},83236:(e,t,s)=>{s.d(t,{A:()=>B});var a=s(69499),i=s(98558),l=s(66243),c=s(48666),r=s(52327),n=s(33590),o=s.n(n),g=s(61995);class u extends a.Component{constructor(e){super(e),this.handleClickBrauzBtn=e=>{window.Brauz_open_book_a_stylist_dialog_with_selected_store(e)}}textFieldToUppercase(e){return{value:e.value.toUpperCase()}}categoryHandler(e){this.props.categoryMainHandler(e)}render(){const{category:e,name:t,nameLink:s,location:n,locationLink:u,itemId:B,openTime:d,thumbnail:h,logo:C,cookTime:w,serves:A,difficulty:m,rating:k,price:p,acceptsOnlineBooking:I,bookingIcon:j,bookingLabel:x,bookingUrl:N,hasBooking:v,index:T,position:S,retailerName:R,isRetailerContent:H,isLogoAsThumbnail:O,thumbnailAltText:E,pageType:f,retailerId:Q}=this.props,J=(0,g.jsxs)("div",{className:"icons",children:[(()=>{let e=[],t=[],s=[];if(k&&k.value){const t=parseInt(k.value);for(let s=1;s<=5;s++)s<=t?e.push((0,g.jsx)("div",{className:"icon icon-star checked"},s)):e.push((0,g.jsx)("div",{className:"icon icon-star"},s))}if(p&&p.value){const e=parseInt(p.value);if(e<=1)t.push((0,g.jsx)("i",{className:"icon icon-dollar"},"priceLevelId1"));else if(2===e||3===e)for(let s=0;s<2;s++)t.push((0,g.jsx)("i",{className:"icon icon-dollar"},"priceLevelId"+s));else if(e>=4)for(let s=0;s<3;s++)t.push((0,g.jsx)("i",{className:"icon icon-dollar"},"priceLevelId"+s))}else t="";return s=e.length||t?(0,g.jsxs)("div",{className:"storerating",children:[(0,g.jsx)("div",{className:"star",children:e}),(0,g.jsx)("div",{className:"dollar",children:(0,g.jsx)("div",{className:"pricelevel",children:(0,g.jsx)("span",{children:t})})})]}):"",s})(),n&&n.value&&(0,g.jsx)(l.A,{iconValue:"location mr-2",linkUrl:u&&u.value,linkName:n,mapInfo:Q&&Q.value?Q.value:"",size:"24"}),d&&d.value&&(0,g.jsx)(l.A,{iconValue:"time mr-2",linkName:d,size:"24"}),w&&w.value&&(0,g.jsx)(l.A,{iconValue:"timer",linkName:w,size:"24"}),A&&A.value&&(0,g.jsx)(l.A,{iconValue:"users",linkName:A,size:"24"}),m&&m.value&&(0,g.jsx)(l.A,{iconValue:"chef-2",linkName:m,size:"24"}),I&&I.value&&(0,g.jsxs)("div",{className:"details-wrapper",children:[j&&j.value?(0,g.jsx)("i",{className:`icon icon-${j.value} mr-2`,style:{fontSize:"24px"}}):(0,g.jsx)("i",{className:"icon icon-calendar-2 mr-2",style:{fontSize:"24px"}}),(0,g.jsx)("div",{className:"text-block",children:v&&v.value?(0,g.jsx)("button",{className:"brauz",onClick:()=>this.handleClickBrauzBtn(B.value),children:(0,g.jsx)(i.Text,{field:x})}):N&&N.value?(0,g.jsx)("a",{href:N.value,target:"_blank",children:(0,g.jsx)(i.Text,{field:x})}):(0,g.jsx)(i.Text,{field:x})})]})]});return(0,g.jsx)("div",{className:"col-12 col-md-4 col-lg-3",onClick:()=>o().dataLayer({dataLayer:{event:"lifestyleClick",lifestyle_page_type:f.value,lifestyle_title:t.value},dataLayerName:"dataLayer"}),children:(0,g.jsxs)(r.default,{position:S,children:[(0,g.jsxs)("div",{className:"animation-range",children:[(0,g.jsx)("div",{className:"image-wrapper  "+(O&&O.value?"display_retailer_logo":""),children:(0,g.jsxs)("a",{href:s&&s.value?s.value:"",className:"name",children:[h&&h.value&&h.value.src?(0,g.jsx)("div",{className:"include_logo_padding",children:(0,g.jsx)(i.Image,{media:{...h.value,src:c},"data-src":h.value.src,className:"tile-image lazyload"})}):(0,g.jsxs)(a.Fragment,{children:[H&&H.value&&(0,g.jsx)("div",{className:"display_retailer_name",children:(0,g.jsx)(i.Text,{field:R})}),(0,g.jsx)("div",{className:"no-image"})]}),B&&B.value&&(C&&C.value&&C.value.src?(0,g.jsx)("div",{className:"tile-logo-wrapper",children:(0,g.jsx)(i.Image,{media:{...C.value,src:c},"data-src":C.value.src,className:"tile-logo lazyload"})}):(0,g.jsx)("div",{className:"no-logo",children:(0,g.jsx)(i.Text,{field:t})}))]})}),f&&f.value?(0,g.jsxs)("div",{className:"title",children:[(0,g.jsxs)("div",{className:"page-type",children:[(0,g.jsx)("div",{className:"pagetype-rectangle"}),(0,g.jsx)(i.Text,{field:f})]}),(0,g.jsx)("div",{className:"name",children:(0,g.jsx)("a",{href:s&&s.value?s.value:"",children:(0,g.jsx)(i.Text,{field:t})})})]}):(0,g.jsxs)("div",{className:"title",children:[e&&e.value&&(0,g.jsx)("div",{className:"category",children:(0,g.jsx)("a",{onClick:()=>this.categoryHandler(e),children:(0,g.jsx)(i.Text,{field:this.textFieldToUppercase(e)})})}),(0,g.jsx)("div",{className:"name",children:(0,g.jsx)("a",{href:s&&s.value?s.value:"",children:(0,g.jsx)(i.Text,{field:t})})}),J]})]}),J]})},t.value+T)}}const B=u},86915:(e,t,s)=>{s.r(t),s.d(t,{default:()=>p});var a=s(69499),i=s(98558),l=s(83236),c=s(43210),r=s.n(c),n=s(33590),o=s.n(n),g=s(363),u=s.n(g),B=s(11501),d=s(24827),h=s(93990),C=s(94551),w=s.n(C),A=s(49055),m=s(61995);class k extends a.Component{constructor(e){super(e),this.handleClearButton=()=>{this.searchTerm.current.value="",this.setState({showClearButton:!1}),this.getResultsList(1)},this.categoryMainHandler=e=>{let t=this.textFieldToLowercase(e).value;"Article"===t&&(t="News"),this.updateMainFilter(t)},this.state={listing:[],hasMoreItems:!0,currentPage:1,totalCount:0,searchResultCountText:"",showClearButton:!1,showLoader:!0,isScrolling:!1,selectedCategory:""},this.searchTerm=a.createRef()}componentDidMount(){this.setState({selectedCategory:this.getUrlParameter("filter_cat")},()=>this.getResultsList(1))}componentDidUpdate(e){this.props.sitecoreContext&&this.props.sitecoreContext.whatsOnMainFilter&&e.sitecoreContext.whatsOnMainFilter!==this.props.sitecoreContext.whatsOnMainFilter&&(this.clearSearch(),this.setState({selectedCategory:this.props.sitecoreContext.whatsOnMainFilter},()=>this.getResultsList(1)))}handleSearchFilter(){this.getResultsList(1),this.searchTerm.current&&""!==this.searchTerm.current.value?this.setState({showClearButton:!0}):this.setState({showClearButton:!1})}clearSearch(){this.searchTerm.current.value="",this.setState({showClearButton:!1})}showResultsCount(){let e;return e=this.state.searchResultCountText?(0,m.jsx)("div",{className:"col-auto whatsonsearch-resultscount",children:this.state.searchResultCountText}):"",e}textFieldToLowercase(e){return{value:this.capitalizeWord(e.value.toLowerCase())}}capitalizeWord(e){return e.charAt(0).toUpperCase()+e.slice(1)}updateMainFilter(e){const t=this.props.sitecoreContext;h.A.setSitecoreContext({...t,whatsOnMainFilter:e,refresh:!0})}composeResultsList(){const{listing:e}=this.state,{NoSearchResultText:t=null}=this.props.fields||{};let s;return s=e.length<1?t&&t.value?(0,m.jsx)("div",{className:"col no-results",children:t.value}):(0,m.jsx)("div",{className:"col no-results",children:"No result. Please try again."}):e.map((e,t)=>{const{PromotionType:s,Name:a,Location:i,PromotionDateText:c,LocationLink:r,Thumbnail:n,PromotionLink:o,AddToCalendarCta:g,IsRetailerContent:u,IsLogoAsThumbnail:B,Retailer:d,HidePublishDate:h,RetailerId:C}=e;return(0,m.jsx)(l.A,{index:!0,category:s,name:a,nameLink:o,location:i,locationLink:r,retailerId:C,openTime:h&&!h.value&&c,thumbnail:n,addToCalendarLink:g,categoryMainHandler:this.categoryMainHandler,position:(0,A.q)(t,4,3),retailerName:d,isRetailerContent:u,isLogoAsThumbnail:B})}),s}getResultsList(e,t){let s="",a="",i="",l="",c="";const{selectedCategory:n}=this.state;n&&"all"!==n&&(i=n),this.searchTerm.current.value&&/\S/.test(this.searchTerm.current.value)?(s=this.searchTerm.current.value.replace(/\s/g,","),o().dataLayer({dataLayer:{event:"performedWOLS",searchTermWOL:this.searchTerm.current.value},dataLayerName:"dataLayer"})):s="";let g=window.document.getElementsByName("ContextItem")[0];l=g.value,c=g.dataset.targetDb,a=`/api/sitecore/promotions/search?pageId=${l}&dbName=${c}&keyword=${s}&promotionType=${i}&pageNumber=${e}&pageSize=12`,t?this.setState({isScrolling:!0}):this.setState({showLoader:!0}),r()({url:a,method:"GET"}).then(t=>{let s=t.data?t.data:null;if(s&&s.ResultList){const t=Math.ceil(s.TotalCount.value/12),a=e>1?this.state.listing.concat(s.ResultList):s.ResultList;this.setState({...this.state,listing:a,totalCount:s.TotalCount.value,searchResultCountText:s.SearchResultCountText&&s.SearchResultCountText.value?s.SearchResultCountText.value:"",currentPage:s.Page.value,hasMoreItems:s.Page.value!=t})}this.setState({showLoader:!1,isScrolling:!1})}).catch(e=>{})}getUrlParameter(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(window.location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))}loadResultsList(){this.getResultsList(this.state.currentPage+1,!0)}render(){const{SearchHelpText:e=null}=this.props.fields||{},{RemoveDefaultMargin:t=""}=this.props.params||{},{ApplySmallMargin:s=""}=this.props.params||{},a=t&&"1"===t?"":s&&"1"===s?"small":"standard",{showLoader:i,isScrolling:l}=this.state;return(0,m.jsx)(B.A,{margin:a,children:(0,m.jsx)("div",{className:"whatson-list-container",children:(0,m.jsxs)("div",{className:"container",children:[(0,m.jsxs)("div",{className:"no-gutters whatsonsearch-row",children:[(0,m.jsxs)("div",{className:"whatsonsearch-searchbar",children:[(0,m.jsx)("input",{className:"form-control",type:"text",placeholder:e&&e.value?e.value:"Search",ref:this.searchTerm,onChange:w().debounce(e=>{this.handleSearchFilter(e)},1e3)}),this.state.showClearButton&&(0,m.jsx)("button",{className:"clear-icon",type:"button",onClick:this.handleClearButton,children:(0,m.jsx)("i",{className:"icon icon-close"})})]}),this.showResultsCount()]}),(0,m.jsxs)(u(),{className:"whatsonsearch-wrapper",style:{height:"auto",overflow:"hidden"},dataLength:this.state.listing.length,next:this.loadResultsList.bind(this),hasMore:this.state.hasMoreItems,children:[!i&&(0,m.jsx)("div",{className:"content-tile-list-wrapper",children:(0,m.jsx)("div",{className:"row",children:this.composeResultsList()})}),(i||l)&&(0,m.jsx)(d.A,{})]})]})})})}}const p=(0,i.withSitecoreContext)()(k)}}]);
//# sourceMappingURL=WhatsOnList.3a6bf2c5.chunk.js.map