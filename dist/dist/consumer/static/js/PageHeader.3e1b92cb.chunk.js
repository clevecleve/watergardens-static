"use strict";(self.webpackChunkconsumer=self.webpackChunkconsumer||[]).push([[1541],{13344:(e,a,t)=>{t.r(a),t.d(a,{default:()=>g});var s=t(69499),i=t(98558),n=t(33590),o=t.n(n),l=(t(4900),t(56331)),r=t(79304),c=t(43210),v=t.n(c),h=t(8002),d=t(79212),u=t(24827),m=t(27529),N=t(61995);class p extends s.Component{constructor(e){var a;super(e),a=this,this.handleWindowResize=()=>{if(window.outerWidth>=992){this.showMobileNav(!1),this.state.showSearch&&this.setState({showSearch:!1,showNav:!1});const e=document.querySelector(".pageheader-navbar-wrapper");if(e&&(e.style.height="auto",e.style.height=e.clientHeight+"px"),document){let e=0,a=0,t=0,s=0;const i=document.querySelector(".js-header-container"),n=document.querySelector(".js-navbar-nav"),o=document.querySelector(".nav-content.active");let l="",r="";i&&(e=window.getComputedStyle(i).getPropertyValue("margin-left").replace("px",""),a=i.clientWidth/2),n&&(l=n.querySelector(".nav-item.active"),l&&(t=l.getBoundingClientRect().x)),o&&(r=o.querySelector(".js-nav-link-list"),s=t-e-a,r&&(r.style.left=s+"px"))}}},this.adjustNavHeight=e=>{if(e&&window.outerWidth>=992){const e=document.querySelector(".pageheader-navbar-wrapper");e&&(e.style.height=e.clientHeight+"px")}},this.loadNavigationData=()=>{let e=window.document.getElementsByName("ContextItem")[0],a=this;const t=e.value,s=e.dataset.targetDb;v()({url:"/api/sitecore/navigation/getnavigation",method:"GET",params:{pageId:t,dbName:s}}).then(e=>{let t=e.data?e.data:null;t&&t.data.Navigations&&a.setState({...a.state,navigations:t.data.Navigations},()=>{a.state.showNav&&a.getSubList()})}).catch(e=>{})},this.handleFocus=()=>{document&&document.querySelector("#consumer-search-bar").focus()},this.handleClearSearch=()=>{document&&document.querySelector(".searchbar .search-cancel")&&document.querySelector(".searchbar .search-cancel").click()},this.showNav=e=>{this.adjustNavHeight(this.state.isSimpleNav),this.state.activeNav!==e&&this.setState({showNav:!0,activeNav:e,activeContent:[]},this.getSubList)},this.showNavMobile=e=>{this.adjustNavHeight(this.state.isSimpleNav),this.state.activeNav!==e&&this.setState({showNav:!1,activeNav:e,activeContent:[]},()=>this.getSubList(!1))},this.showNavMobile=async e=>{this.adjustNavHeight(this.state.isSimpleNav),this.state.activeNav!==e&&this.setState({showNav:!1,activeNav:e,activeContent:[]},()=>this.getSubList(!1))},this.showMobileNav=e=>{this.state.showMobileNav!==e&&this.setState({showMobileNav:e})},this.getSubList=async function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];console.log("======== getSubList ========");let t=window.document.getElementsByName("ContextItem")[0];const s=t.value,i=t.dataset.targetDb,{navigations:n,isSimpleNav:o,activeNav:l}=a.state;if(!o){let t=n.find(e=>e.DisplayName.value===l);if(t&&t.SecondaryNavIds&&t.SecondaryNavIds.value&&(!t.SecondaryNavigations||!t.SecondaryNavigations.length))try{a.setState({isLoadingSecondary:!0});let e=`/api/sitecore/navigation/getsecondarynavigation?a=1&pageId=${s}&dbName=${i}`;let o;if(t.SecondaryNavIds.value.split(",").forEach(a=>{e+=`&SecondaryNavIds=${a.trim()}`}),!o)try{const{data:a}=await v()({url:e,method:"GET"});o=a.data.SecondaryNavigations}catch(r){console.error("SUB NAV ERROR!!!!!"),console.error(r)}t.SecondaryNavigations=o;const c=n.map(e=>e.DisplayName.value===l?{...e,SecondaryNavigations:o}:e);a.setState({navigations:c,isLoadingSecondary:!1})}catch(c){return console.error("Error loading secondary navigation:",c),void a.setState({isLoadingSecondary:!1})}if(t&&t.SecondaryNavigations){const s=t.SecondaryNavigations.map(e=>({name:e.DisplayName.value,url:e.LinkUrl.value}));a.setState({activeSubList:s,activeSub:s.length?s[0].name:""},e?a.getSubContent:()=>{})}else t&&t.Components&&t.Components.length>0?a.setState({activeSubList:[],activeSub:"",activeContent:a.renderDirectComponents(t.Components)}):a.setState({activeSubList:[],activeSub:"",activeContent:[]})}},this.hideOverlay=()=>{(0,m.fY)(),this.setState({showSearch:!1,showNav:!1,activeNav:null,activeContent:[],activeSubList:[]})},this.setSub=e=>{this.state.activeSub!==e&&this.setState({activeSub:e},this.getSubContent)},this.getColumnSize=e=>"25"===e?"3":"50"===e?"6":"75"===e?"9":"100"===e?"12":"",this.renderDirectComponents=e=>{const a=[];return e.forEach((e,t)=>{const s="NavLinkList"===e.ComponentName.value?e.Links:e;a.push((0,N.jsx)("div",{className:"col-12",children:(0,N.jsx)("div",{className:"nav-component",children:(0,N.jsx)(l.A,{type:e.ComponentName.value,item:s,centre:this.props.params.activeCentre,size:"12"})})},`directComp-${t}`))}),a},this.getSubContent=()=>{const e=[];let a=this.state.navigations.find(e=>e.DisplayName.value===this.state.activeNav).SecondaryNavigations,t=a?a.find(e=>e.DisplayName.value===this.state.activeSub):void 0;if(t){let a=t.Components,s=t.Layout.value.split("-"),i=[];i[0]=a.filter(e=>"1"===e.ColumnPosition.value),i[1]=a.filter(e=>"2"===e.ColumnPosition.value),i[2]=a.filter(e=>"3"===e.ColumnPosition.value),i.map((a,t)=>{if(a.length>0){let i=this.getColumnSize(s[a[0].ColumnPosition.value-1]);e.push((0,N.jsx)("div",{className:`col-${i} order-${a[0].ColumnPosition.value}`,children:a.map((e,a)=>(0,N.jsx)("div",{className:"nav-component",children:(0,N.jsx)(l.A,{type:e.ComponentName.value,item:e,centre:this.props.params.activeCentre,size:i})},`rowID-${a}`))},`compId-${t}`))}}),this.setState({activeContent:e})}else this.setState({activeContent:[]})},this.renderComplexNavContent=()=>{let e="";return this.state.showNav&&(e=(0,N.jsx)("div",{className:"nav-container "+(this.state.showNav?"active":""),children:this.state.isLoadingSecondary?(0,N.jsx)(u.A,{}):(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("div",{className:"nav-sub",children:(0,N.jsx)("div",{className:"container",children:this.state.activeSubList&&this.state.activeSubList.map((e,a)=>(0,N.jsx)("div",{className:"sub-item",onMouseEnter:()=>{this.setSub(e.name),o().dataLayer({dataLayer:{event:"viewSubNav",subNavActive:e.name},dataLayerName:"dataLayer"})},children:(0,N.jsx)("a",{href:e.url,className:"btn btn-link  "+(this.state.activeSub===e.name?"active":""),children:(0,N.jsx)(i.Text,{field:{value:e.name}})})},`myId-${a}`))})}),(0,N.jsx)("div",{className:"nav-content",children:(0,N.jsx)("div",{className:"container",children:(0,N.jsx)("div",{className:"row",children:this.state.activeContent})})})]})})),e},this.renderSimpleNavContent=()=>{const{activeNav:e,navigations:a,showNav:t}=this.state;let s="",n=0;return s=(0,N.jsx)("div",{className:"nav-container "+(t?"active":""),children:(0,N.jsx)("div",{className:"container",children:a.map((a,t)=>{const{DisplayName:s,NavLink:o,SecondaryNavigations:r,SecondaryNavIds:c,Components:v}=a;c&&c.value||r&&r.length||v&&v.length||o&&o.value&&o.value.href||n--;let h=0,d=!1;if(e&&e.toLowerCase()===s.value.toLowerCase()&&document){let e=0,a=0,t=0;const s=document.querySelector(".js-header-container"),i=document.querySelector(".js-navbar-nav");s&&(e=window.getComputedStyle(s).getPropertyValue("margin-left").replace("px",""),a=s.clientWidth/2),i&&(t=i.querySelectorAll(".nav-item")[n].getBoundingClientRect().x),h=t-e-a}return n++,(0,N.jsx)("div",{className:`nav-content \n              ${e&&e.toLowerCase()===s.value.toLowerCase()?"active":""}\n\n            `,children:(0,N.jsxs)("div",{className:"row",children:[(0,N.jsx)("div",{className:"col col-lg-6",children:v&&v.length>0&&v.map((e,a)=>{const{ComponentName:t,ComponentTitle:s}=e;let n="";return t&&"NavLinkList"!==t.value&&(d=!0,n=(0,N.jsxs)("div",{children:["NavPopularTimes"===t.value&&(0,N.jsx)("div",{className:"nav-populartimes__header",children:(0,N.jsx)(i.Text,{field:s})}),(0,N.jsx)(l.A,{type:t.value,item:e,centre:this.props.params.activeCentre,size:"12"})]},t.value+a)),n})}),(0,N.jsx)("div",{className:"col col-lg-6",children:v&&v.length>0&&v.map((e,a)=>{const{ComponentName:t,Links:s}=e;let i="";return t&&"NavLinkList"===t.value&&(i=(0,N.jsx)("div",{className:"js-nav-link-list",style:d?{}:{left:h+"px"},children:(0,N.jsx)(l.A,{type:t.value,item:s})},t.value+a)),i})})]})},s.value+t)})})}),s},this.renderNavLink=(e,a,t,s)=>e&&e.length>0&&e.map((e,n)=>{const{DisplayName:o,NavLink:l,SecondaryNavigations:r,SecondaryNavIds:c,Components:v}=e;let h="";return c&&c.value||r&&r.length>0||v&&v.length>0?h=(0,N.jsx)("li",{className:"nav-item "+(a===o.value?"active":""),children:(0,N.jsx)("a",{className:"nav-link",onClick:()=>{(0,m.mh)(),this.showNav(o.value)},onMouseEnter:()=>{t&&s&&((0,m.mh)(),this.showNav(o.value))},children:(0,N.jsx)(i.Text,{field:{value:o.value}})})},`liId-${n}`):l&&l.value&&l.value.href&&(h=(0,N.jsx)("li",{className:"nav-item "+(a===o.value?"active":""),children:(0,N.jsx)("a",{className:"nav-link",...l.value,href:l.value.href+l.value.querystring,onMouseEnter:()=>{t&&s&&((0,m.mh)(),this.showNav(o.value))},children:(0,N.jsx)(i.Text,{field:o})})},`liId-${n}`)),h}),this.getRenderedNavSize=e=>{let a=0;return e&&e.length?(e.forEach(e=>{const{NavLink:t,SecondaryNavigations:s,SecondaryNavIds:i,Components:n}=e;(i&&i.value||s&&s.length||n&&n.length||t&&t.value&&t.value.href)&&a++}),a>=6?"big":"standard"):a},this.state={showSearch:!1,showNav:!1,showMobileNav:!1,activeNav:null,activeSub:null,activeContent:[],activeSubList:[],navigations:[],isSimpleNav:!1}}componentDidMount(){const{UseSimpleHeader:e,Navigations:a}=this.props.fields;let t=!1;e&&e.value&&(t=!0);let s=[];a&&Array.isArray(a)&&(s=a.map(function e(a){if(Array.isArray(a))return a.map(e);if(a&&"object"===typeof a){if(a.fields&&"object"===typeof a.fields&&null!==a.fields)return e({...a,...a.fields,fields:void 0});if(null===a.fields){const t=Object.keys(a);if(1===t.length&&"fields"===t[0])return null;const s={};for(const i in a)a.hasOwnProperty(i)&&"fields"!==i&&(s[i]=e(a[i]));return s}const t={};for(const s in a)a.hasOwnProperty(s)&&(t[s]=e(a[s]));return t}return a})),document&&(a&&a.length?this.setState({...this.state,navigations:s,isSimpleNav:t}):this.loadNavigationData()),window&&t&&window.addEventListener("resize",this.handleWindowResize)}render(){const{CentreLogo:e,BackButtonLink:a,UseSimpleHeader:t,LogoLayout:s,Navigations:n}=this.props.fields||{},{navigations:o,activeNav:l,showNav:c,showSearch:v,showMobileNav:u,isSimpleNav:m}=this.state;return(0,N.jsxs)("div",{className:""+(t&&t.value?"simple-header":""),children:[(0,N.jsx)(h.A,{data:this.props.fields,isNavShown:c}),m&&(0,N.jsx)("div",{className:"search-bar-main container "+(v?"search-active":""),children:(0,N.jsx)(i.Placeholder,{name:"jss-searchmodal-right",rendering:this.props.rendering,isSimple:!0,show:v})}),(0,N.jsxs)("div",{className:"pageheader-navbar-wrapper "+(c?"active":""),children:[(0,N.jsxs)("div",{className:"js-header-container container "+(c?"fixed-top":""),children:[(0,N.jsxs)("nav",{className:"navbar navbar-expand-lg ",children:[(0,N.jsx)("span",{className:""+(c?"":"hide"),children:(0,N.jsx)(d.A,{logo:e,uniqueKey:"centre-logo-page-header",isSticky:c,simpleNav:c,logoLayout:s?s.value:"Default",isGeneric:!0})}),(0,N.jsxs)("div",{className:"mobile-nav",children:[(!v||m&&c)&&(0,N.jsx)("button",{className:"nav-link search",onClick:()=>{m?(this.setState({showSearch:!0}),this.handleFocus()):this.setState({showSearch:!0})},"aria-label":"nav link search",children:(0,N.jsx)("i",{className:"icon icon-outlined-search"})}),(0,N.jsx)("button",{className:"navbar-toggler",type:"button",onClick:()=>{this.showMobileNav(!0)},children:(0,N.jsx)("i",{className:"icon icon-outlined-menu"})})]}),(0,N.jsx)("div",{className:"collapse navbar-collapse",id:"navbarSupportedContent",children:(0,N.jsxs)("ul",{className:`js-navbar-nav navbar-nav ml-auto\n                    ${c?"active":""} \n                    nav-size-${this.getRenderedNavSize(o)}\n                  `,children:[this.renderNavLink(o,l,m,c),(0,N.jsxs)("li",{className:"nav-item",children:[(!m&&(c||v)||m&&v)&&(0,N.jsx)("button",{className:"nav-link",onClick:this.hideOverlay,children:(0,N.jsx)("i",{className:"icon icon-close"})}),(!v&&m||!m&&!v&&!c)&&(0,N.jsx)("i",{className:"icon icon-outlined-search",onClick:()=>{m?(this.adjustNavHeight(m),this.setState({showSearch:!0,showNav:!0,activeNav:null}),this.handleFocus()):this.setState({showSearch:!0})}})]})]})})]}),a&&a.value&&(a.value.href||a.value.text)&&(0,N.jsx)("div",{className:"pageheader-navbar-wrapper__backbtn "+(c||u?"is-hidden":""),children:a.value.href?(0,N.jsx)("div",{children:(0,N.jsxs)("a",{href:a.value.href,title:a.value.title,target:a.value.target,children:[(0,N.jsx)("i",{className:"icon icon-arrow-left"}),(0,N.jsx)("span",{children:a.value.text})]})}):a.value.text})]}),m?this.renderSimpleNavContent():this.renderComplexNavContent(),v&&!m&&(0,N.jsx)("div",{className:"search-container "+(c?"active":""),children:(0,N.jsx)("div",{className:"search-wrapper",children:(0,N.jsxs)("div",{className:"container",children:[(0,N.jsx)("div",{className:"clearfix",children:(0,N.jsx)("i",{onClick:this.hideOverlay,className:"icon icon-close float-right"})}),(0,N.jsx)("div",{className:"search-content",children:(0,N.jsx)(i.Placeholder,{name:"jss-searchmodal-right",rendering:this.props.rendering,isSimple:!1})})]})})}),u&&(0,N.jsx)(r.A,{onCloseMobileNav:()=>{this.showMobileNav(!1)},navigations:this.state.navigations,centreLogo:e,isSimpleNav:m,logoLayout:s.value,onShowNav:this.showNavMobile})]}),c&&m&&(0,N.jsx)("div",{className:"js-close-nav",onMouseEnter:this.hideOverlay})]})}}const g=p}}]);
//# sourceMappingURL=PageHeader.3e1b92cb.chunk.js.map